<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>My Project: Prism Connect SDK</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Prism Connect SDK </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Prism Connect SDK is a first class client library for the Prism Connect API. In addition to support for making all of the necessary network calls to the API, the SDK provides a standard suite of abstracted computer vision algorithms for interacting most effectively with the API. Finally, the SDK comes with a curated set of small example executables that can be used to build more complex applications, and they double as utilities for interacting with the API from the command line.</p>
<h2>Design</h2>
<p>Simplicity, modularity, and flatness inform the design of the SDK. Here's how you query for all of the Prism accounts that can be accessed through a particular API token:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{c++}</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;#include &lt;iostream&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;#include &lt;api/client.h&gt;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;#include &lt;api/environment.h&gt;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;int main() {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    prism::connect::api::Client client{prism::connect::api::environment::ApiRoot(),</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                                       prism::connect::api::environment::ApiToken()};</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    auto accounts = client.QueryAccounts();</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    for (const auto&amp; account : accounts) {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        std::cout &lt;&lt; &quot;Account[&quot; &lt;&lt; account.id_ &lt;&lt; &quot;]:&quot; &lt;&lt; std::endl;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        std::cout &lt;&lt; &quot;Name: &quot; &lt;&lt; account.name_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        std::cout &lt;&lt; &quot;Url: &quot; &lt;&lt; account.url_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        std::cout &lt;&lt; &quot;Instruments Url: &quot; &lt;&lt; account.instruments_url_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    }</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    return 0;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
</div><!-- fragment --><p>Similarly, performing background subtraction on a sequence of input images should be straightforward and fool-proof:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{c++}</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;#include &lt;iostream&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;#include &lt;vector&gt;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;#include &lt;opencv2/core.hpp&gt;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;#include &lt;processors/background.h&gt;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;int main() {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    prism::connect::processors::Background background;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    std::vector&lt;cv::Mat&gt; input_images;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    for (const auto&amp; input_image : input_images) {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        background.AddImage(input_image);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    }</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    cv::Mat background_image = background.GetBackgroundImage();</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    cv::Mat foreground_mask = background.GetForegroundMask();</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    return 0;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
</div><!-- fragment --><p>The goal of the SDK is to reduce the number of steps from the surface (aka <code>int main()</code>) to the core functionality of processing visual data and POSTing it to the Prism Connect API. This enables and rewards producing small, highly focused and functional executables that perform a single job correctly and efficiently, a critical property of successful embedded development workflows.</p>
<h2>Modules</h2>
<p>The SDK is broken up into modules that are each responsible for a specific set of behaviors.</p>
<h3><code>api</code></h3>
<p>To make network calls to the Prism Connect API, use the <code>api</code> module, which encapsulates authentication and network services in a single class, the <code>Client</code>. Every public method of an instance of <code>Client</code> is a network call, with no exceptions. This makes it easy to identify in source code what method calls must be treated as potentially blocking or erroneous.</p>
<p>After successfully constructing a <code>Client</code>, one has access to these methods:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{c++}</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// Get the list of Accounts</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;std::vector&lt;Account&gt; accounts = client.QueryAccounts();</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;// Get a specific Account by account id</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Account account = client.QueryAccount(id);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;// Get the list of Instruments belonging to an Account</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;std::vector&lt;Instrument&gt; client.QueryInstruments(account);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;// Get a specific Instrument belonging to an Account by instrument id</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Instrument client.QueryInstrument(account, id);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;// Register an unregistered Instrument to an Account</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;client.RegisterInstrument(account, instrument);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;// POST image, video, or time series data to a registered Instrument</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;client.PostImage(instrument, &quot;ImageKey&quot;, std::chrono::system_clock::now(),</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                 std::chrono::system_clock::now(), &quot;image.jpg&quot;, image_data);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;client.PostVideo(instrument, &quot;VideoKey&quot;, std::chrono::system_clock::now(),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                 std::chrono::system_clock::now(), &quot;video.mp4&quot;, video_data);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;client.PostTimeSeries(instrument, &quot;TimeSeriesKey&quot;, std::chrono::system_clock::now(), json_data);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;// In the above examples, image_data and video_data are std::vector&lt;char&gt;, aka, binary data, and</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;// json_data is type nlohmann::json, which is defined in an included dependency</div>
</div><!-- fragment --><p>The classes <code>Account</code> and <code>Instrument</code> are light classes with essentially all POD (plain old data) type members, and do not interact with the network on their own. Only when used in conjunction with a <code>Client</code> will a network call be made on behalf of them.</p>
<h3><code>sources</code></h3>
<p>This module defines a common interface for creating sources for image frames or video frames. Clients of those interfaces can work with pointers to frame sources instead of concrete instantiations of those frame sources. This allows for a common set of executables and algorithms to run against a well defined interface even after changing out the input source.</p>
<p>To implement the interface, extend the <code>SourceInterface</code> class defined in <code>source-interface.h</code> like in <code>file-source.h</code>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{c++}</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;class FileSource : public SourceInterface {</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  public:</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    FileSource(const std::string&amp; file_path);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    virtual FramePtr GetFrame() override;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  private:</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    void freeFrame(Frame* frame);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    std::ifstream input_file_;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;};</div>
</div><!-- fragment --><p>Here, a source of images is taken from a file, even though a client of <code>SourceInterface</code> wouldn't need to know that. Since they only have access to a pointer to <code>SourceInterface</code>, they can still use the frames taken from a file to run their algorithms by calling <code>GetFrame()</code>.</p>
<p>Several example sources are provided, and this is likely to be the first point of integration for a user of the SDK. Defining the source of frames and codifying that in a subclass of <code>SourceInterface</code> is the most critical step in doing a Prism Connect integration through the SDK.</p>
<h3><code>processors</code></h3>
<p>This module provides a standard suite of computer vision algorithms, which under the hood use OpenCV.</p>
<h3><code>util</code></h3>
<p>A catch-all module for bottom of the pyramid algorithms and helpers. <code>util</code> has no dependencies on other modules and exists for the sole purpose of removing boilerplate or non-integral code from them. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
